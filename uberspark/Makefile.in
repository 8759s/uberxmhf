######
# top-level Makefile for UberSpark
# author: amit vasudevan (amitvasudevan@acm.org)
######


include ./common.mk


###### targets

.PHONY: build-tools
build-tools:
	cd $(USPARK_TOOLSDIR) && $(RM) umfcommon.annot umfcommon.cmi umfcommon.cmo umfcommon.cmt umfcommon.cmx umfcommon.o
	cd $(USPARK_TOOLSDIR) && $(MAKE) -f umf.mk -w all
	cd $(USPARK_TOOLSDIR) && $(RM) umfcommon.annot umfcommon.cmi umfcommon.cmo umfcommon.cmt umfcommon.cmx umfcommon.o
	cd $(USPARK_TOOLSDIR) && $(MAKE) -f ubp.mk -w all
	cd $(USPARK_TOOLSDIR) && $(RM) umfcommon.annot umfcommon.cmi umfcommon.cmo umfcommon.cmt umfcommon.cmx umfcommon.o
	cd $(USPARK_TOOLSDIR) && $(MAKE) -f uccomp.mk -w all
	cd $(USPARK_TOOLSDIR) && $(RM) umfcommon.annot umfcommon.cmi umfcommon.cmo umfcommon.cmt umfcommon.cmx umfcommon.o
	cd $(USPARK_TOOLSDIR) && $(MAKE) -f ucasm.mk -w all
	cd $(USPARK_TOOLSDIR) && $(RM) umfcommon.annot umfcommon.cmi umfcommon.cmo umfcommon.cmt umfcommon.cmx umfcommon.o
	cd $(USPARK_TOOLSDIR) && $(MAKE) -f uhwm.mk -w all
	

.PHONY: all
all:
	@echo $(AC_PREFIX)
	@echo $(AC_LIBDIR)
	@echo $(USPARK_DIR)
	@echo $(USPARK_OBJDIR)
	@echo $(USPARK_HWMDIR)
	@echo $(USPARK_LIBSDIR)
	@echo $(USPARK_INCLUDEDIR)
	@echo $(USPARK_TOOLSDIR)
	

.PHONY: clean
clean:

# http://www.gnu.org/software/automake/manual/automake.html#Clean
.PHONY: distclean
distclean: clean
	$(RM) config.log config.status
	$(RM) -rf Makefile


###### autoconf rules

Makefile: Makefile.in config.status
	./config.status $@

config.status: configure
	./config.status --recheck

configure: configure.ac
	autoconf --output=configure configure.ac

