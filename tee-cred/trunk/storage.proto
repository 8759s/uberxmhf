package AkvpStorage;

message Everything
{
  required bytes sealed_master_secret=;
  required bytes mac_of_header=;
  required Header header=;
  repeated MacdEncdEntry macd_encd_entries=;
}

message Header
{
  bytes sealed_private_key=;
  bytes public_key=;
  bytes sealed_master_symmetric_secret=;
  string audit_pub_key_pem=;
}

message MacdEncdEntry
{
  string key=1;
  bytes salt=;
  bytes mac=;
  bytes encd_entry=;
}

message Entry
{
  string key=1;

  bytes encrypted_val=;
}

