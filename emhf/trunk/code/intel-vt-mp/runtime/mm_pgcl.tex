

/* Initial Condition (USF) */
\forall i,j . P[i][j][ALLCOLS] := 0;

/* Parallel Guarded Command */
XVisor(K,K) == shadow_new_context(*) || shadow_invalidate_page(*) || shadow_page_fault(*)

\varphi === P[i][j][PRESENT] ? P[i][j][ADDR] < GUEST_PHYMEM_LIMIT;



shadow_page_fault ==
  forall (i,j) {
  * AND P[i][j][PRESENT] AND P[i][j][GUEST_ADDR] < MAX ? P[i][j][Shadow] = P[i][j][Guest];
}


shadow_invalidate_page ==
  forall (i,j,) {
  P[i][j][PRESENT] && * ? P[i][j][k] := 0;    
}


shadow_new_context ==
  shadow_guest_CR3 = guest_CR3;
forall (i,j,k) {
  P[i][j][k] = 0;
}

