<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>W5300 - SOCKET APIs: include/socket.h File Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.6 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>include/socket.h File Reference</h1><hr><a name="_details"></a><h2>Detailed Description</h2>
<b> WIZnet <code>SOCKET</code> API function definition </b> 
<p>
For user application, <b>WIZnet</b> provides <code>SOCKET</code> API functions which are similar to <b>Berkeley</b> <code>SOCKET</code> API.<br>
<p>
<dl class="author" compact><dt><b>Author:</b></dt><dd>MidnightCow </dd></dl>
<dl class="date" compact><dt><b>Date:</b></dt><dd>11/25/2008 </dd></dl>
<dl class="version" compact><dt><b>Version:</b></dt><dd>1.2.1</dd></dl>
<b> Revision History :</b> <br>
 <table border="1" cellspacing="3" cellpadding="3">
<tr>
<td><b>Date</b>  </td><td><b>Version</b>  </td><td><b>Author</b>  </td><td><b>Description</b>   </td></tr>
<tr>
<td>24/03/2008 </td><td>1.0.0 </td><td>MidnightCow </td><td>Release with W5300 launching  </td></tr>
<tr>
<td>15/05/2008 </td><td>1.1.0 </td><td>MidnightCow </td><td>Refer to M_15052008.<br>
Modify the warning code block in <a class="el" href="socket_8h.html#5672da1c2194f153a238b7e24a0ac435" title="It receives TCP data on a connection SOCKET.">recv()</a>.   </td></tr>
<tr>
<td>04/07/2008 </td><td>1.1.1 </td><td>MidnightCow </td><td>Refer to M_04072008.<br>
Modify the warning code block in <a class="el" href="socket_8h.html#5672da1c2194f153a238b7e24a0ac435" title="It receives TCP data on a connection SOCKET.">recv()</a>.   </td></tr>
<tr>
<td>08/08/2008 </td><td>1.2.0 </td><td>MidnightCow </td><td>Refer to M_08082008.<br>
Modify <a class="el" href="socket_8h.html#4243cf1670c850a7bf1e77799afdc53f" title="Close a SOCKET.">close()</a>.  </td></tr>
<tr>
<td>11/25/2008 </td><td>1.2.1 </td><td>Bongjun  </td><td>Refer to M_11252008.<br>
Modify <a class="el" href="socket_8h.html#4243cf1670c850a7bf1e77799afdc53f" title="Close a SOCKET.">close()</a>.  </td></tr>
</table>

<p>Definition in file <a class="el" href="socket_8h-source.html">socket.h</a>.</p>

<p>
<code>#include &quot;<a class="el" href="types_8h-source.html">types.h</a>&quot;</code><br>
<code>#include &quot;<a class="el" href="w5300_8h-source.html">w5300.h</a>&quot;</code><br>

<p>
<a href="socket_8h-source.html">Go to the source code of this file.</a><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="types_8h.html#dde6aaee8457bee49c2a92621fe22b79">uint8</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="socket_8h.html#8b0247cecfe600e1e8b0df8ed2e77e79">socket</a> (<a class="el" href="types_8h.html#302434b7916f66d677e9c6f13515de3e">SOCKET</a> s, <a class="el" href="types_8h.html#dde6aaee8457bee49c2a92621fe22b79">uint8</a> protocol, <a class="el" href="types_8h.html#05f6b0ae8f6a6e135b0e290c25fe0e4e">uint16</a> port, <a class="el" href="types_8h.html#05f6b0ae8f6a6e135b0e290c25fe0e4e">uint16</a> flag)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Open a SOCKET.  <a href="#8b0247cecfe600e1e8b0df8ed2e77e79"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="socket_8h.html#4243cf1670c850a7bf1e77799afdc53f">close</a> (<a class="el" href="types_8h.html#302434b7916f66d677e9c6f13515de3e">SOCKET</a> s)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Close a SOCKET.  <a href="#4243cf1670c850a7bf1e77799afdc53f"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="types_8h.html#dde6aaee8457bee49c2a92621fe22b79">uint8</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="socket_8h.html#6b113f87d2f4dde2a5db37b36505c2df">connect</a> (<a class="el" href="types_8h.html#302434b7916f66d677e9c6f13515de3e">SOCKET</a> s, <a class="el" href="types_8h.html#dde6aaee8457bee49c2a92621fe22b79">uint8</a> *addr, <a class="el" href="types_8h.html#05f6b0ae8f6a6e135b0e290c25fe0e4e">uint16</a> port)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">It tries to connect a client.  <a href="#6b113f87d2f4dde2a5db37b36505c2df"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="socket_8h.html#ddfd77bbc2b33e6edbcb8944e6a7e998">disconnect</a> (<a class="el" href="types_8h.html#302434b7916f66d677e9c6f13515de3e">SOCKET</a> s)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">It tries to disconnect a connection <code>SOCKET</code> with a peer.  <a href="#ddfd77bbc2b33e6edbcb8944e6a7e998"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="types_8h.html#dde6aaee8457bee49c2a92621fe22b79">uint8</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="socket_8h.html#98a63bbd78fcd6b0fbbea85c773f0306">listen</a> (<a class="el" href="types_8h.html#302434b7916f66d677e9c6f13515de3e">SOCKET</a> s)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">It is listening to a connect-request from a client.  <a href="#98a63bbd78fcd6b0fbbea85c773f0306"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="types_8h.html#4b435a49c74bb91f284f075e63416cb6">uint32</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="socket_8h.html#1679bdae7e6cd6a583576d3a80110095">send</a> (<a class="el" href="types_8h.html#302434b7916f66d677e9c6f13515de3e">SOCKET</a> s, <a class="el" href="types_8h.html#dde6aaee8457bee49c2a92621fe22b79">uint8</a> *buf, <a class="el" href="types_8h.html#4b435a49c74bb91f284f075e63416cb6">uint32</a> len)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">It sends TCP data on a connection <code>SOCKET</code>.  <a href="#1679bdae7e6cd6a583576d3a80110095"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="types_8h.html#4b435a49c74bb91f284f075e63416cb6">uint32</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="socket_8h.html#5672da1c2194f153a238b7e24a0ac435">recv</a> (<a class="el" href="types_8h.html#302434b7916f66d677e9c6f13515de3e">SOCKET</a> s, <a class="el" href="types_8h.html#dde6aaee8457bee49c2a92621fe22b79">uint8</a> *buf, <a class="el" href="types_8h.html#4b435a49c74bb91f284f075e63416cb6">uint32</a> len)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">It receives TCP data on a connection <code>SOCKET</code>.  <a href="#5672da1c2194f153a238b7e24a0ac435"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="types_8h.html#4b435a49c74bb91f284f075e63416cb6">uint32</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="socket_8h.html#0673e6e4b3c74bf6f5a38ece483e8f55">sendto</a> (<a class="el" href="types_8h.html#302434b7916f66d677e9c6f13515de3e">SOCKET</a> s, <a class="el" href="types_8h.html#dde6aaee8457bee49c2a92621fe22b79">uint8</a> *buf, <a class="el" href="types_8h.html#4b435a49c74bb91f284f075e63416cb6">uint32</a> len, <a class="el" href="types_8h.html#dde6aaee8457bee49c2a92621fe22b79">uint8</a> *addr, <a class="el" href="types_8h.html#05f6b0ae8f6a6e135b0e290c25fe0e4e">uint16</a> port)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">It sends UDP, IPRAW, or MACRAW data.  <a href="#0673e6e4b3c74bf6f5a38ece483e8f55"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top"><a class="el" href="types_8h.html#4b435a49c74bb91f284f075e63416cb6">uint32</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="socket_8h.html#fb55f9f683d86303d095d6df2d18bffd">recvfrom</a> (<a class="el" href="types_8h.html#302434b7916f66d677e9c6f13515de3e">SOCKET</a> s, <a class="el" href="types_8h.html#dde6aaee8457bee49c2a92621fe22b79">uint8</a> *buf, <a class="el" href="types_8h.html#4b435a49c74bb91f284f075e63416cb6">uint32</a> len, <a class="el" href="types_8h.html#dde6aaee8457bee49c2a92621fe22b79">uint8</a> *addr, <a class="el" href="types_8h.html#05f6b0ae8f6a6e135b0e290c25fe0e4e">uint16</a> *port)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">It receives UDP, IPRAW, or MACRAW data.  <a href="#fb55f9f683d86303d095d6df2d18bffd"></a><br></td></tr>
</table>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="4243cf1670c850a7bf1e77799afdc53f"></a><!-- doxytag: member="socket.h::close" ref="4243cf1670c850a7bf1e77799afdc53f" args="(SOCKET s)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void close           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="types_8h.html#302434b7916f66d677e9c6f13515de3e">SOCKET</a>&nbsp;</td>
          <td class="paramname"> <em>s</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Close a SOCKET. 
<p>
It closes a SOCKET and releases its all used resouces. <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>s</em>&nbsp;</td><td><code>SOCKET</code> number. It is valid when 0 &lt;= s &lt;= <a class="el" href="iinchip__conf_8h.html#e5a2e3b1eefb3a10a2485e28a4ccdb59">MAX_SOCK_NUM</a> - 1.</td></tr>
  </table>
</dl>
<dl class="note" compact><dt><b>Note:</b></dt><dd>In TCP mode, if you disconnect a <code>SOCKET</code> using <a class="el" href="socket_8h.html#4243cf1670c850a7bf1e77799afdc53f" title="Close a SOCKET.">close()</a>, a <b>FIN</b> packet won't be sent to the peer. </dd></dl>
<dl class="warning" compact><dt><b>Warning:</b></dt><dd>In TCP mode, You'd better to call <a class="el" href="socket_8h.html#4243cf1670c850a7bf1e77799afdc53f" title="Close a SOCKET.">close()</a> after disconect() for the safe terminating. Refer to <a class="el" href="group___s_o_c_k_e_t___r_e_g.html#g4499795fb09c886fe6fedf4275add011">Sn_SSR</a> bug phase. </dd></dl>

<p>Definition at line <a class="el" href="socket_8c-source.html#l00057">57</a> of file <a class="el" href="socket_8c-source.html">socket.c</a>.</p>

<p>References <a class="el" href="w5300_8c-source.html#l00783">getIINCHIP_TxMAX()</a>, <a class="el" href="w5300_8c-source.html#l00286">getSn_MR()</a>, <a class="el" href="w5300_8c-source.html#l00430">getSn_TX_FSR()</a>, <a class="el" href="socket_8c-source.html#l00284">sendto()</a>, <a class="el" href="w5300_8c-source.html#l00299">setSn_CR()</a>, <a class="el" href="w5300_8c-source.html#l00322">setSn_IR()</a>, <a class="el" href="w5300_8h-source.html#l01392">Sn_CR_CLOSE</a>, <a class="el" href="w5300_8h-source.html#l01280">Sn_MR_TCP</a>, <a class="el" href="w5300_8h-source.html#l01287">Sn_MR_UDP</a>, <a class="el" href="socket_8c-source.html#l00038">socket()</a>, and <a class="el" href="w5300_8c-source.html#l01200">wait_10ms()</a>.</p>

<p>Referenced by <a class="el" href="main_8c-source.html#l00218">loopback_tcpc()</a>, <a class="el" href="main_8c-source.html#l00162">loopback_tcps()</a>, <a class="el" href="main_8c-source.html#l00274">loopback_udp()</a>, and <a class="el" href="main_8c-source.html#l00055">Main()</a>.</p>

</div>
</div><p>
<a class="anchor" name="6b113f87d2f4dde2a5db37b36505c2df"></a><!-- doxytag: member="socket.h::connect" ref="6b113f87d2f4dde2a5db37b36505c2df" args="(SOCKET s, uint8 *addr, uint16 port)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="types_8h.html#dde6aaee8457bee49c2a92621fe22b79">uint8</a> connect           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="types_8h.html#302434b7916f66d677e9c6f13515de3e">SOCKET</a>&nbsp;</td>
          <td class="paramname"> <em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#dde6aaee8457bee49c2a92621fe22b79">uint8</a> *&nbsp;</td>
          <td class="paramname"> <em>addr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#05f6b0ae8f6a6e135b0e290c25fe0e4e">uint16</a>&nbsp;</td>
          <td class="paramname"> <em>port</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
It tries to connect a client. 
<p>
It operates a <code>SOCKET</code> as "TCP CLIENT" and sends a connect-request(<b>SYN</b> packet) to "TCP SERVER".<br>
 It is valid only in TCP mode. <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>s</em>&nbsp;</td><td><code>SOCKET</code> number. It is valid when 0 &lt;= s &lt;= <a class="el" href="iinchip__conf_8h.html#e5a2e3b1eefb3a10a2485e28a4ccdb59">MAX_SOCK_NUM</a> - 1. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>addr</em>&nbsp;</td><td>IP address of "TCP SERVER" </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>port</em>&nbsp;</td><td>Listen port number of "TCP SERVER". </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>success - 1<br>
 fail - 0 </dd></dl>

<p>Definition at line <a class="el" href="socket_8c-source.html#l00086">86</a> of file <a class="el" href="socket_8c-source.html">socket.c</a>.</p>

<p>References <a class="el" href="w5300_8c-source.html#l00065">IINCHIP_WRITE()</a>, <a class="el" href="w5300_8c-source.html#l00299">setSn_CR()</a>, <a class="el" href="w5300_8h-source.html#l01351">Sn_CR_CONNECT</a>, <a class="el" href="w5300_8h-source.html#l00758">Sn_DIPR</a>, and <a class="el" href="w5300_8h-source.html#l00735">Sn_DPORTR</a>.</p>

<p>Referenced by <a class="el" href="main_8c-source.html#l00218">loopback_tcpc()</a>.</p>

</div>
</div><p>
<a class="anchor" name="ddfd77bbc2b33e6edbcb8944e6a7e998"></a><!-- doxytag: member="socket.h::disconnect" ref="ddfd77bbc2b33e6edbcb8944e6a7e998" args="(SOCKET s)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void disconnect           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="types_8h.html#302434b7916f66d677e9c6f13515de3e">SOCKET</a>&nbsp;</td>
          <td class="paramname"> <em>s</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
It tries to disconnect a connection <code>SOCKET</code> with a peer. 
<p>
It sends a disconnect-request(<b>FIN</b> packet) to "TCP SERVER" or "TCP CLIENT".<br>
 It is valid only in TCP mode. <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>s</em>&nbsp;</td><td><code>SOCKET</code> number. It is valid when 0 &lt;= s &lt;= <a class="el" href="iinchip__conf_8h.html#e5a2e3b1eefb3a10a2485e28a4ccdb59">MAX_SOCK_NUM</a> - 1. </td></tr>
  </table>
</dl>

<p>Definition at line <a class="el" href="socket_8c-source.html#l00113">113</a> of file <a class="el" href="socket_8c-source.html">socket.c</a>.</p>

<p>References <a class="el" href="w5300_8c-source.html#l00299">setSn_CR()</a>, and <a class="el" href="w5300_8h-source.html#l01371">Sn_CR_DISCON</a>.</p>

<p>Referenced by <a class="el" href="main_8c-source.html#l00218">loopback_tcpc()</a>, and <a class="el" href="main_8c-source.html#l00162">loopback_tcps()</a>.</p>

</div>
</div><p>
<a class="anchor" name="98a63bbd78fcd6b0fbbea85c773f0306"></a><!-- doxytag: member="socket.h::listen" ref="98a63bbd78fcd6b0fbbea85c773f0306" args="(SOCKET s)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="types_8h.html#dde6aaee8457bee49c2a92621fe22b79">uint8</a> listen           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="types_8h.html#302434b7916f66d677e9c6f13515de3e">SOCKET</a>&nbsp;</td>
          <td class="paramname"> <em>s</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
It is listening to a connect-request from a client. 
<p>
It operates a <code>SOCKET</code> as "TCP SERVER" and waits a connect-request(<b>SYN</b> packet) from a "TCP CLIENT".<br>
 It is valid only in TCP mode. <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>s</em>&nbsp;</td><td><code>SOCKET</code> number. It is valid when 0 &lt;= s &lt;= <a class="el" href="iinchip__conf_8h.html#e5a2e3b1eefb3a10a2485e28a4ccdb59">MAX_SOCK_NUM</a> - 1. </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>success - 1<br>
 fail - 0 </dd></dl>

<p>Definition at line <a class="el" href="socket_8c-source.html#l00118">118</a> of file <a class="el" href="socket_8c-source.html">socket.c</a>.</p>

<p>References <a class="el" href="w5300_8c-source.html#l00334">getSn_SSR()</a>, <a class="el" href="w5300_8c-source.html#l00299">setSn_CR()</a>, <a class="el" href="w5300_8h-source.html#l01332">Sn_CR_LISTEN</a>, and <a class="el" href="w5300_8h-source.html#l01607">SOCK_INIT</a>.</p>

<p>Referenced by <a class="el" href="main_8c-source.html#l00162">loopback_tcps()</a>.</p>

</div>
</div><p>
<a class="anchor" name="5672da1c2194f153a238b7e24a0ac435"></a><!-- doxytag: member="socket.h::recv" ref="5672da1c2194f153a238b7e24a0ac435" args="(SOCKET s, uint8 *buf, uint32 len)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="types_8h.html#4b435a49c74bb91f284f075e63416cb6">uint32</a> recv           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="types_8h.html#302434b7916f66d677e9c6f13515de3e">SOCKET</a>&nbsp;</td>
          <td class="paramname"> <em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#dde6aaee8457bee49c2a92621fe22b79">uint8</a> *&nbsp;</td>
          <td class="paramname"> <em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#4b435a49c74bb91f284f075e63416cb6">uint32</a>&nbsp;</td>
          <td class="paramname"> <em>len</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
It receives TCP data on a connection <code>SOCKET</code>. 
<p>
It is used to read incoming data on a connection <code>SOCKET</code>.<br>
 It is valid only in TCP mode. <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>s</em>&nbsp;</td><td><code>SOCKET</code> number. It is valid when 0 &lt;= s &lt;= <a class="el" href="iinchip__conf_8h.html#e5a2e3b1eefb3a10a2485e28a4ccdb59">MAX_SOCK_NUM</a> - 1. </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>buf</em>&nbsp;</td><td>A buffer for the imcoming data<br>
 The length of <em>buf</em> <b>should</b> be equal or greater than <em>len</em> + 1, in order to prevent the memory violation. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>len</em>&nbsp;</td><td>The byte length of the data in <em>buf</em> </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>It returns the number of bytes received.</dd></dl>
<dl class="note" compact><dt><b>Note:</b></dt><dd>When receiving TCP data from a peer, <br>
<br>
<ul>
<li>In case of <a class="el" href="w5300_8h.html#eaa24ab8cd0c2a4dd8af7e5cc1e95488">Sn_MR_ALIGN</a> = '1' <br>
 <b>W5300</b> adds <b>PACKET-INFO</b>(2bytes lenght) in front of all received <b>DATA</b>(max <a class="el" href="group___s_o_c_k_e_t___r_e_g.html#g4c0679d6d132651861d71e1f6e5d91de">Sn_MSSR</a> lenght) packet in internal RX memory. The added <b>PACKET-INFO</b> contains the size of <b>DATA</b> packet. If the size of received <b>DATA</b> packet is odd number, 1 byte dummy data is added. The host <b>should</b> read this dummy data first and ignore it.<br>
<br>
</li><li>In case of <a class="el" href="w5300_8h.html#eaa24ab8cd0c2a4dd8af7e5cc1e95488">Sn_MR_ALIGN</a> = '0' <br>
 <em>iichip</em> receives only <b>DATA</b> packet without <b>PACKET-INFO</b>. Therefore, All size of the received data <b>should</b> be a even number.<br>
<br>
 Below shows the format of received TCP data.</li></ul>
</dd></dl>
<div align="center">
<img src="TCP_Data_Format.jpg" alt="TCP_Data_Format.jpg">
<p><strong>&lt;The format of received TCP data&gt;</strong></p></div>
 <dl compact><dt><b><a class="el" href="warning.html#_warning000001">Warning:</a></b></dt><dd></dd></dl>
<dl class="warning" compact><dt><b>Warning:</b></dt><dd>When <code>SOCKETn</code> is used only to receive data without transmitting data, the slow data receiving process by the host can cause internal RX memory full. In this case, even though <b>W5300</b> window size (the maximum size of receivable data) is not '0', by misunderstanding the window size as '0', the peer does not transmit the data, and waits until window size is increased. It is the cause of decreasing data receiving performance of <b>W5300</b>. In order to solve the problem, the host processes the data received in internal RX memory first and notify the peer that the window size of <b>W5300</b> is increased by received data size. <br>
 After <a class="el" href="w5300_8h.html#282df6e5d976e94953d4f9f32f182827">Sn_CR_RECV</a> command, add to the below code. <div class="fragment"><pre class="fragment"> <span class="keywordflow">if</span>(<a class="code" href="w5300_8h.html#a394edd575e56d8df1a86b1acbf99a0d" title="It gets Sn_RX_RSR value.">getSn_RX_RSR</a>(s) == 0)                 
 {                                        
    <a class="code" href="w5300_8h.html#4d44f61ede001397eb459edb21a69ddc" title="It gets Sn_KPALVTR value.">setSn_TX_WRSR</a>(s,1);                   
    <a class="code" href="w5300_8h.html#1d16ce9862da9b031b4e28f69e7a635b" title="Basic I/O function.">IINCHIP_WRITE</a>(<a class="code" href="group___s_o_c_k_e_t___r_e_g.html#ga9618a9d3252f21e1d9b21d901ccea20" title="SOCKETn TX FIFO register">Sn_TX_FIFOR</a>(s),0x0000); 
    <a class="code" href="w5300_8h.html#cd910a328187fc386e019be2863427d1" title="It sets Sn_CR value.">setSn_CR</a>(s,<a class="code" href="w5300_8h.html#77bad5ce966d13306653a83b47a3caed" title="SEND command value of Sn_CR.">Sn_CR_SEND</a>);               
    <span class="keywordflow">while</span>(!(<a class="code" href="w5300_8h.html#59374b796f37fd0b6a5b5dcd3cb9e0c2" title="It gets Sn_IR value.">getSn_IR</a>(s) &amp; <a class="code" href="w5300_8h.html#8973589ea9a777133aa1bec1c03298c9" title="Send OK bit of Sn_IR.">Sn_IR_SENDOK</a>)); 
    <a class="code" href="w5300_8h.html#e178c212ddad5fa1c1bb58dc283791b9" title="It sets Sn_IR value.">setSn_IR</a>(s,Sn_IR_SENDOK);             
 }                                        
</pre></div> <b> There is no need when <code>SOCKETn</code> is used to both receive and transmit data.</b> </dd></dl>

<p>Definition at line <a class="el" href="socket_8c-source.html#l00217">217</a> of file <a class="el" href="socket_8c-source.html">socket.c</a>.</p>

<p>References <a class="el" href="w5300_8c-source.html#l00314">getSn_IR()</a>, <a class="el" href="w5300_8c-source.html#l00444">getSn_RX_RSR()</a>, <a class="el" href="w5300_8c-source.html#l00052">IINCHIP_READ()</a>, <a class="el" href="w5300_8c-source.html#l00065">IINCHIP_WRITE()</a>, <a class="el" href="w5300_8h-source.html#l00128">MR</a>, <a class="el" href="w5300_8h-source.html#l01061">MR_FS</a>, <a class="el" href="w5300_8c-source.html#l00299">setSn_CR()</a>, <a class="el" href="w5300_8c-source.html#l00322">setSn_IR()</a>, <a class="el" href="w5300_8c-source.html#l00424">setSn_TX_WRSR()</a>, <a class="el" href="w5300_8h-source.html#l01458">Sn_CR_RECV</a>, <a class="el" href="w5300_8h-source.html#l01400">Sn_CR_SEND</a>, <a class="el" href="w5300_8h-source.html#l01541">Sn_IR_SENDOK</a>, <a class="el" href="w5300_8h-source.html#l00551">Sn_MR</a>, <a class="el" href="w5300_8h-source.html#l01211">Sn_MR_ALIGN</a>, <a class="el" href="w5300_8h-source.html#l00954">Sn_TX_FIFOR</a>, and <a class="el" href="w5300_8c-source.html#l00714">wiz_read_buf()</a>.</p>

<p>Referenced by <a class="el" href="main_8c-source.html#l00218">loopback_tcpc()</a>, and <a class="el" href="main_8c-source.html#l00162">loopback_tcps()</a>.</p>

</div>
</div><p>
<a class="anchor" name="fb55f9f683d86303d095d6df2d18bffd"></a><!-- doxytag: member="socket.h::recvfrom" ref="fb55f9f683d86303d095d6df2d18bffd" args="(SOCKET s, uint8 *buf, uint32 len, uint8 *addr, uint16 *port)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="types_8h.html#4b435a49c74bb91f284f075e63416cb6">uint32</a> recvfrom           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="types_8h.html#302434b7916f66d677e9c6f13515de3e">SOCKET</a>&nbsp;</td>
          <td class="paramname"> <em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#dde6aaee8457bee49c2a92621fe22b79">uint8</a> *&nbsp;</td>
          <td class="paramname"> <em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#4b435a49c74bb91f284f075e63416cb6">uint32</a>&nbsp;</td>
          <td class="paramname"> <em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#dde6aaee8457bee49c2a92621fe22b79">uint8</a> *&nbsp;</td>
          <td class="paramname"> <em>addr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#05f6b0ae8f6a6e135b0e290c25fe0e4e">uint16</a> *&nbsp;</td>
          <td class="paramname"> <em>port</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
It receives UDP, IPRAW, or MACRAW data. 
<p>
It is used to read incoming data and to store a destination information.<br>
 On the IPRAW <code>SOCKET</code>, the <em>port</em> parameter are ignored.<br>
 On the MACRAW <code>SOCKET</code>, the <em>addr</em> and <em>port</em> parameters are ignored, making <code><a class="el" href="socket_8h.html#fb55f9f683d86303d095d6df2d18bffd" title="It receives UDP, IPRAW, or MACRAW data.">recvfrom()</a></code> equivalent to <a class="el" href="socket_8h.html#5672da1c2194f153a238b7e24a0ac435" title="It receives TCP data on a connection SOCKET.">recv()</a>. But, The destination and source information is included in front of <em>buf</em>. <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>s</em>&nbsp;</td><td><code>SOCKET</code> number. It is valid when 0 &lt;= s &lt;= <a class="el" href="iinchip__conf_8h.html#e5a2e3b1eefb3a10a2485e28a4ccdb59">MAX_SOCK_NUM</a> - 1. </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>buf</em>&nbsp;</td><td>A buffer for the imcoming data<br>
 The length of <em>buf</em> <b>should</b> be equal or greater than <em>len</em> + 1, in order to prevent the memory violation. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>len</em>&nbsp;</td><td>The byte length of the data in <em>buf</em> </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>addr</em>&nbsp;</td><td>An optional pointer to the address of destination. </td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>port</em>&nbsp;</td><td>An optional the port number of destination. </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>It returns the number of bytes received.</dd></dl>
<dl class="note" compact><dt><b>Note:</b></dt><dd>When receiving data from a peer, <b>W5300</b> adds the different <b>PACKET-INFO</b> in front of all received <b>DATA</b>(max <a class="el" href="group___s_o_c_k_e_t___r_e_g.html#g4c0679d6d132651861d71e1f6e5d91de">Sn_MSSR</a> lenght) packet in internal RX memory. The added <b>PACKET-INFO</b> contains basically the <b>DATA</b> packet size which length is 2bytes and contains extra information such as destination IP address according to <code>SOCKETn</code> mode.<br>
 If the size of received <b>DATA</b> packet is odd number, 1 byte dummy data is added. The host <b>should</b> read this dummy data first and ignore it. <br>
<br>
<ul>
<li>In case of UDP mode <br>
 <div align="center">
<img src="UDP_Data_Format.jpg" alt="UDP_Data_Format.jpg">
<p><strong>&lt;The format of received UDP data&gt;</strong></p></div>
 Destination IP address and port number are stored respectively in the parameters <em>addr</em> and <em>port</em>. And <b>DATA</b> packet is stored in the parameter <em>buf</em>.<br>
<br>
</li><li>In case of IPRAW mode <br>
 <div align="center">
<img src="IP_Data_Format.jpg" alt="IP_Data_Format.jpg">
<p><strong>&lt;The format of received IPRAW data&gt;</strong></p></div>
 Destination IP address is stored in the parameter <em>addr</em>. And <b>DATA</b> packet is stored in the parameter <em>buf</em>.<br>
<br>
</li><li>In case of MACRAW mode <br>
 <div align="center">
<img src="MAC_Data_Format.jpg" alt="MAC_Data_Format.jpg">
<p><strong>&lt;The format of received MACRAW data&gt;</strong></p></div>
 Destination and source MAC, and type are stored in the parameter <em>buf</em>. But, CRC is ignored. <br>
<br>
</li></ul>
</dd></dl>
<dl compact><dt><b><a class="el" href="warning.html#_warning000003">Warning:</a></b></dt><dd></dd></dl>
<dl class="warning" compact><dt><b>Warning:</b></dt><dd>In case that free buffer size of internal RX memory is smaller than the size of receiving MAC RAW data, <br>
 some parts of un-acceptable <b>PACKET-INFO</b> and <b>DATA</b> packet of the MACRAW data can be saved in internal RX memory. This can cause the error in analyzing PACKET-INFO, and receiving correct MACRAW data. This problem is more likely to happen when internal RX memory gets close full.<br>
 This can be solved by ignoring some loss of MACRAW data.<br>
<br>
<ul>
<li>By performing internal RX memory process as quick as possible, prevent the memory to be full <br>
<br>
</li><li>By receiving only its own MACRAW data, reduce the receiving burden.<br>
 Set the Sn_MR_MF bit of S0_MR by calling <a class="el" href="socket_8h.html#8b0247cecfe600e1e8b0df8ed2e77e79">socket()</a> with Sn_MR_MF <em>flag</em> <div class="fragment"><pre class="fragment">   <a class="code" href="socket_8h.html#8b0247cecfe600e1e8b0df8ed2e77e79" title="Open a SOCKET.">socket</a>(0,<a class="code" href="w5300_8h.html#8426a69a5d58f909bb1c7ce12afad0a5" title="Protocol bits of Sn_MR.">Sn_MR_MACRAW</a>,0x1000,<a class="code" href="w5300_8h.html#ee30c1b91458498c61c4b9958e31bfc1" title="MAC filter bit of Sn_MR.">Sn_MR_MF</a>);
</pre></div> <br>
</li><li>In case that the free size of internal RX memory is smaller than 1528 -Default MTU(1514)+ PACKET-INFO(2)+DATA packet(8)+CRC(4)- close SOCKET 0. After closing the SOCKET0, Process all received MACRAW data and the reopen the SOCKET0.<br>
 For example, <div class="fragment"><pre class="fragment">   <span class="comment">// Assume that you can process the MACRAW data by this function.</span>
   <span class="keywordtype">void</span> process_macraw_data(<a class="code" href="types_8h.html#dde6aaee8457bee49c2a92621fe22b79">uint8</a>* mac_data, <a class="code" href="types_8h.html#4b435a49c74bb91f284f075e63416cb6">uint32</a> len); 

   <span class="comment">// main example</span>
   <span class="keywordtype">void</span> main(<span class="keywordtype">void</span>)
   {
      <a class="code" href="types_8h.html#4ca2d97e571b049be6f4cdcfaa1ab946">int32</a> remained_rsr = 0;
      <a class="code" href="types_8h.html#4ca2d97e571b049be6f4cdcfaa1ab946">int32</a> rsr = 0;
      <a class="code" href="types_8h.html#4ca2d97e571b049be6f4cdcfaa1ab946">int32</a> recv_len = 0;
      <a class="code" href="types_8h.html#dde6aaee8457bee49c2a92621fe22b79">uint8</a> data_buf[2048];

      <span class="keywordflow">while</span>(1)
      {
         <span class="keywordflow">switch</span>(<a class="code" href="w5300_8h.html#fe282f3897d4bb9fd507ebae32d91ef5" title="It gets Sn_SSR value.">getSn_SSR</a>(0))
         {
            <span class="keywordflow">case</span> <a class="code" href="w5300_8h.html#aa1a6ffb014a972dbbe82a7fc8b4673b" title="It is the status that SOCKET0 is open as MACRAW mode.">SOCK_MACRAW</a>:   
               rsr = <a class="code" href="w5300_8h.html#a394edd575e56d8df1a86b1acbf99a0d" title="It gets Sn_RX_RSR value.">getSn_RX_RSR</a>(0);
               <span class="keywordflow">if</span>(rsr &gt; 0) 
               {  
                  <span class="comment">// check the received size.</span>
                  <span class="keywordflow">if</span>(getIINCHIP_MaxRX(0) - rsr &lt; 1528) <span class="comment">// Abnormal</span>
                  {
                     remained_rsr = rsr;
                     <a class="code" href="socket_8h.html#4243cf1670c850a7bf1e77799afdc53f" title="Close a SOCKET.">close</a>(s);
                     <span class="keywordflow">while</span>(remained_rsr &gt; 0)           <span class="comment">// Process all received data.</span>
                     {
                        recv_len = <a class="code" href="socket_8h.html#fb55f9f683d86303d095d6df2d18bffd" title="It receives UDP, IPRAW, or MACRAW data.">recvfrom</a>(0,data_buf,remained_rsr,0,0);
                        remained_rsr -= (recv_len+2+4); <span class="comment">// length of DATA packet size - 2bytes, length of CRC - 4 bytes</span>
                        <span class="keywordflow">if</span>(remained_rsr &lt; 0) 
                        {
                           <span class="comment">// Error. It maybe receive an un-acceptable MACRAW data and should be ignored that.</span>
                           <span class="keywordflow">break</span>;
                        }
                        process_macraw_data(data_buf,recv_len);
                     }
                  }
                  <span class="keywordflow">else</span>                                 <span class="comment">// Normal</span>
                  {  
                     recv_len = <a class="code" href="socket_8h.html#fb55f9f683d86303d095d6df2d18bffd" title="It receives UDP, IPRAW, or MACRAW data.">recvfrom</a>(0,data_buf,remained_rsr,0,0);
                     process_macraw_data(data_buf,recv_len);
                  }
               }
               <span class="keywordflow">break</span>;
            <span class="keywordflow">case</span> <a class="code" href="w5300_8h.html#8e14b15b210852d2812514526de5c004" title="It is the status that resource of SOCKETn is released.">SOCK_CLOSED</a>:
               <a class="code" href="socket_8h.html#8b0247cecfe600e1e8b0df8ed2e77e79" title="Open a SOCKET.">socket</a>(0,<a class="code" href="w5300_8h.html#8426a69a5d58f909bb1c7ce12afad0a5" title="Protocol bits of Sn_MR.">Sn_MR_MACRAW</a>,0x1000,<a class="code" href="w5300_8h.html#ee30c1b91458498c61c4b9958e31bfc1" title="MAC filter bit of Sn_MR.">Sn_MR_MF</a>); <span class="comment">// open or re-open the MACRAW SOCKET with MAC filter flag.</span>
               <span class="keywordflow">break</span>;
         } <span class="comment">// end switch</span>
      } <span class="comment">// end while</span>
   } <span class="comment">// end main</span>
</pre></div> </li></ul>
</dd></dl>

<p>Definition at line <a class="el" href="socket_8c-source.html#l00342">342</a> of file <a class="el" href="socket_8c-source.html">socket.c</a>.</p>

<p>References <a class="el" href="w5300_8c-source.html#l00052">IINCHIP_READ()</a>, <a class="el" href="w5300_8h-source.html#l00128">MR</a>, <a class="el" href="w5300_8h-source.html#l01061">MR_FS</a>, <a class="el" href="w5300_8c-source.html#l00299">setSn_CR()</a>, <a class="el" href="w5300_8h-source.html#l01458">Sn_CR_RECV</a>, <a class="el" href="w5300_8h-source.html#l00551">Sn_MR</a>, <a class="el" href="w5300_8h-source.html#l01294">Sn_MR_IPRAW</a>, <a class="el" href="w5300_8h-source.html#l01302">Sn_MR_MACRAW</a>, <a class="el" href="w5300_8h-source.html#l01287">Sn_MR_UDP</a>, and <a class="el" href="w5300_8c-source.html#l00714">wiz_read_buf()</a>.</p>

<p>Referenced by <a class="el" href="main_8c-source.html#l00274">loopback_udp()</a>.</p>

</div>
</div><p>
<a class="anchor" name="1679bdae7e6cd6a583576d3a80110095"></a><!-- doxytag: member="socket.h::send" ref="1679bdae7e6cd6a583576d3a80110095" args="(SOCKET s, uint8 *buf, uint32 len)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="types_8h.html#4b435a49c74bb91f284f075e63416cb6">uint32</a> send           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="types_8h.html#302434b7916f66d677e9c6f13515de3e">SOCKET</a>&nbsp;</td>
          <td class="paramname"> <em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#dde6aaee8457bee49c2a92621fe22b79">uint8</a> *&nbsp;</td>
          <td class="paramname"> <em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#4b435a49c74bb91f284f075e63416cb6">uint32</a>&nbsp;</td>
          <td class="paramname"> <em>len</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
It sends TCP data on a connection <code>SOCKET</code>. 
<p>
It is used to write outgoing data on a connection <code>SOCKET</code>.<br>
 It is valid only in TCP mode. <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>s</em>&nbsp;</td><td><code>SOCKET</code> number. It is valid when 0 &lt;= s &lt;= <a class="el" href="iinchip__conf_8h.html#e5a2e3b1eefb3a10a2485e28a4ccdb59">MAX_SOCK_NUM</a> - 1. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>buf</em>&nbsp;</td><td>A buffer containing the data to be transmitted </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>len</em>&nbsp;</td><td>The byte length of the data in <em>buf</em> </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>If no error occurs, it returns the total number of bytes sent, which can be less than the number indicated by len when <em>len</em> is greater than the allocated size of internal TX memory.<br>
 If error such as timeout and abnormally disconnect occurs, it returns 0.</dd></dl>
<dl class="remark" compact><dt><b>Remarks:</b></dt><dd>It is a blocking function which doesn't return until <em>len</em> lenght data is transmitted completely.</dd></dl>
<dl class="note" compact><dt><b>Note:</b></dt><dd>if you want to use non blocking function, <b>"do{...}while(freesize &lt; ret)"</b> code block can be replaced with the below code. <br>
 <div class="fragment"><pre class="fragment"> <span class="keywordflow">while</span>((freesize = <a class="code" href="w5300_8h.html#a974554f2c4fd6ab70d963d6dd2fc733" title="It gets Sn_TX_FSR value.">getSn_TX_FSR</a>(s))==0); It can tranmit data as many as free size
       ret = freesize;
</pre></div> </dd></dl>

<p>Definition at line <a class="el" href="socket_8c-source.html#l00133">133</a> of file <a class="el" href="socket_8c-source.html">socket.c</a>.</p>

<p>References <a class="el" href="socket_8c-source.html#l00035">check_sendok_flag</a>, <a class="el" href="w5300_8c-source.html#l00783">getIINCHIP_TxMAX()</a>, <a class="el" href="w5300_8c-source.html#l00314">getSn_IR()</a>, <a class="el" href="w5300_8c-source.html#l00334">getSn_SSR()</a>, <a class="el" href="w5300_8c-source.html#l00430">getSn_TX_FSR()</a>, <a class="el" href="w5300_8h-source.html#l00128">MR</a>, <a class="el" href="w5300_8c-source.html#l00299">setSn_CR()</a>, <a class="el" href="w5300_8c-source.html#l00322">setSn_IR()</a>, <a class="el" href="w5300_8c-source.html#l00424">setSn_TX_WRSR()</a>, <a class="el" href="w5300_8h-source.html#l01400">Sn_CR_SEND</a>, <a class="el" href="w5300_8h-source.html#l01541">Sn_IR_SENDOK</a>, <a class="el" href="w5300_8h-source.html#l01692">SOCK_CLOSE_WAIT</a>, <a class="el" href="w5300_8h-source.html#l01579">SOCK_CLOSED</a>, <a class="el" href="w5300_8h-source.html#l01655">SOCK_ESTABLISHED</a>, and <a class="el" href="w5300_8c-source.html#l00648">wiz_write_buf()</a>.</p>

<p>Referenced by <a class="el" href="main_8c-source.html#l00218">loopback_tcpc()</a>, and <a class="el" href="main_8c-source.html#l00162">loopback_tcps()</a>.</p>

</div>
</div><p>
<a class="anchor" name="0673e6e4b3c74bf6f5a38ece483e8f55"></a><!-- doxytag: member="socket.h::sendto" ref="0673e6e4b3c74bf6f5a38ece483e8f55" args="(SOCKET s, uint8 *buf, uint32 len, uint8 *addr, uint16 port)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="types_8h.html#4b435a49c74bb91f284f075e63416cb6">uint32</a> sendto           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="types_8h.html#302434b7916f66d677e9c6f13515de3e">SOCKET</a>&nbsp;</td>
          <td class="paramname"> <em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#dde6aaee8457bee49c2a92621fe22b79">uint8</a> *&nbsp;</td>
          <td class="paramname"> <em>buf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#4b435a49c74bb91f284f075e63416cb6">uint32</a>&nbsp;</td>
          <td class="paramname"> <em>len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#dde6aaee8457bee49c2a92621fe22b79">uint8</a> *&nbsp;</td>
          <td class="paramname"> <em>addr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#05f6b0ae8f6a6e135b0e290c25fe0e4e">uint16</a>&nbsp;</td>
          <td class="paramname"> <em>port</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
It sends UDP, IPRAW, or MACRAW data. 
<p>
It is normally used on a connectionless <code>SOCKET</code> to send a datagram to a specific peer identified by the to parameter(<em>addr</em>, <em>port</em>). Even if the connectionless <code>SOCKET</code> has been previously connected to a specific address, the <em>addr</em> and <em>port</em> parameters override the destination address for that particular datagram only.<br>
<br>
 On the IPRAW <code>SOCKET</code>, the <em>port</em> parameter are ignored.<br>
 On the MACRAW <code>SOCKET</code>, the <em>addr</em> and <em>port</em> parameters are ignored, making <code><a class="el" href="socket_8h.html#0673e6e4b3c74bf6f5a38ece483e8f55" title="It sends UDP, IPRAW, or MACRAW data.">sendto()</a></code> equivalent to <a class="el" href="socket_8h.html#1679bdae7e6cd6a583576d3a80110095" title="It sends TCP data on a connection SOCKET.">send()</a>. But, The destination and source information <b>must</b> be included in front of <em>buf</em>. <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>s</em>&nbsp;</td><td><code>SOCKET</code> number. It is valid when 0 &lt;= s &lt;= <a class="el" href="iinchip__conf_8h.html#e5a2e3b1eefb3a10a2485e28a4ccdb59">MAX_SOCK_NUM</a> - 1. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>buf</em>&nbsp;</td><td>A buffer containing the data to be transmitted </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>len</em>&nbsp;</td><td>The byte length of the data in <em>buf</em> </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>addr</em>&nbsp;</td><td>An optional pointer to the address of destination. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>port</em>&nbsp;</td><td>An optional the port number of destination. </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>If no error occurs, it returns the total number of bytes sent, which can be less than the number indicated by len when <em>len</em> is greater than the allocated size of internal TX memory.<br>
 If error such as ARP timeout and abnormally close occurs, it returns 0.</dd></dl>
<dl class="remark" compact><dt><b>Remarks:</b></dt><dd>It is a blocking function which doesn't return until Sn_IR_SENDOK becomes '1'. It should wait in order to prevent from overriding the destination information.</dd></dl>
<dl compact><dt><b><a class="el" href="warning.html#_warning000002">Warning:</a></b></dt><dd></dd></dl>
<dl class="warning" compact><dt><b>Warning:</b></dt><dd>If <a class="el" href="socket_8h.html#0673e6e4b3c74bf6f5a38ece483e8f55" title="It sends UDP, IPRAW, or MACRAW data.">sendto()</a> is failed by ARP timeout, <a class="el" href="group___s_o_c_k_e_t___r_e_g.html#g91d0cb53e22206b143b192e59aca4511">Sn_TX_FSR</a> is decreased as size of the transmitted data. If ARP timeout occurs continuously, Sn_RX_FSR maybe become 0 and any data can't be transmitted. But, don't worry about that. If <a class="el" href="socket_8h.html#0673e6e4b3c74bf6f5a38ece483e8f55" title="It sends UDP, IPRAW, or MACRAW data.">sendto()</a> successes only once, Sn_RX_FSR is perfectly recovered. </dd></dl>

<p>Definition at line <a class="el" href="socket_8c-source.html#l00284">284</a> of file <a class="el" href="socket_8c-source.html">socket.c</a>.</p>

<p>References <a class="el" href="w5300_8c-source.html#l00783">getIINCHIP_TxMAX()</a>, <a class="el" href="w5300_8c-source.html#l00314">getSn_IR()</a>, <a class="el" href="w5300_8c-source.html#l00334">getSn_SSR()</a>, <a class="el" href="w5300_8c-source.html#l00065">IINCHIP_WRITE()</a>, <a class="el" href="w5300_8c-source.html#l00299">setSn_CR()</a>, <a class="el" href="w5300_8c-source.html#l00322">setSn_IR()</a>, <a class="el" href="w5300_8c-source.html#l00424">setSn_TX_WRSR()</a>, <a class="el" href="w5300_8h-source.html#l01400">Sn_CR_SEND</a>, <a class="el" href="w5300_8h-source.html#l00758">Sn_DIPR</a>, <a class="el" href="w5300_8h-source.html#l00735">Sn_DPORTR</a>, <a class="el" href="w5300_8h-source.html#l01541">Sn_IR_SENDOK</a>, <a class="el" href="w5300_8h-source.html#l01548">Sn_IR_TIMEOUT</a>, <a class="el" href="w5300_8h-source.html#l01579">SOCK_CLOSED</a>, and <a class="el" href="w5300_8c-source.html#l00648">wiz_write_buf()</a>.</p>

<p>Referenced by <a class="el" href="socket_8c-source.html#l00057">close()</a>, and <a class="el" href="main_8c-source.html#l00274">loopback_udp()</a>.</p>

</div>
</div><p>
<a class="anchor" name="8b0247cecfe600e1e8b0df8ed2e77e79"></a><!-- doxytag: member="socket.h::socket" ref="8b0247cecfe600e1e8b0df8ed2e77e79" args="(SOCKET s, uint8 protocol, uint16 port, uint16 flag)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="types_8h.html#dde6aaee8457bee49c2a92621fe22b79">uint8</a> socket           </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="types_8h.html#302434b7916f66d677e9c6f13515de3e">SOCKET</a>&nbsp;</td>
          <td class="paramname"> <em>s</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#dde6aaee8457bee49c2a92621fe22b79">uint8</a>&nbsp;</td>
          <td class="paramname"> <em>protocol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#05f6b0ae8f6a6e135b0e290c25fe0e4e">uint16</a>&nbsp;</td>
          <td class="paramname"> <em>port</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="types_8h.html#05f6b0ae8f6a6e135b0e290c25fe0e4e">uint16</a>&nbsp;</td>
          <td class="paramname"> <em>flag</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Open a SOCKET. 
<p>
It opens a SOCKET according <em>protocol</em> and bind the <code>SOCKET</code> with <em>port</em> number. <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>s</em>&nbsp;</td><td><code>SOCKET</code> number. It is valid when 0 &lt;= s &lt;= <a class="el" href="iinchip__conf_8h.html#e5a2e3b1eefb3a10a2485e28a4ccdb59">MAX_SOCK_NUM</a> - 1. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>protocol</em>&nbsp;</td><td><code>SOCKET</code> protocol such as TCP, UDP and IP.<br>
 Refer to <a class="el" href="w5300_8h.html#111a5f7d5eb14054bd5a895dabad372d">Sn_MR_TCP</a>, <a class="el" href="w5300_8h.html#1a31c891ae1c9cf808542b96ae8fdeb8">Sn_MR_UDP</a>, <a class="el" href="w5300_8h.html#e2eb5ec5fdac56d474184b34db00d92a">Sn_MR_IPRAW</a>, <a class="el" href="w5300_8h.html#8426a69a5d58f909bb1c7ce12afad0a5">Sn_MR_MACRAW</a> and <a class="el" href="w5300_8h.html#8971fc245493cc0ff2a6e7b2df484a13">Sn_MR_PPPoE</a>. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>port</em>&nbsp;</td><td>port number to be binded </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>flag</em>&nbsp;</td><td><code>SOCKET</code> option such as alignment, no-delayed ack, and etc.<br>
 Refer to <a class="el" href="w5300_8h.html#eaa24ab8cd0c2a4dd8af7e5cc1e95488">Sn_MR_ALIGN</a>, <a class="el" href="w5300_8h.html#c93105c327d64a318d7388c31ccb5075">Sn_MR_MULTI</a>, <a class="el" href="w5300_8h.html#ee30c1b91458498c61c4b9958e31bfc1">Sn_MR_MF</a> and <a class="el" href="w5300_8h.html#ffbdfabc2d0bb33ef649d916506f040e">Sn_MR_ND</a>/<a class="el" href="w5300_8h.html#82bfbc5d456722cbe5200317860d3fb8">Sn_MR_IGMPv</a>. </td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>Always, It returns 1. </dd></dl>

<p>Definition at line <a class="el" href="socket_8c-source.html#l00038">38</a> of file <a class="el" href="socket_8c-source.html">socket.c</a>.</p>

<p>References <a class="el" href="socket_8c-source.html#l00035">check_sendok_flag</a>, <a class="el" href="w5300_8c-source.html#l00334">getSn_SSR()</a>, <a class="el" href="w5300_8c-source.html#l00052">IINCHIP_READ()</a>, <a class="el" href="socket_8c-source.html#l00028">iinchip_source_port</a>, <a class="el" href="w5300_8c-source.html#l00065">IINCHIP_WRITE()</a>, <a class="el" href="w5300_8c-source.html#l00299">setSn_CR()</a>, <a class="el" href="w5300_8h-source.html#l01318">Sn_CR_OPEN</a>, <a class="el" href="w5300_8h-source.html#l00551">Sn_MR</a>, and <a class="el" href="w5300_8h-source.html#l00680">Sn_PORTR</a>.</p>

<p>Referenced by <a class="el" href="socket_8c-source.html#l00057">close()</a>, <a class="el" href="main_8c-source.html#l00218">loopback_tcpc()</a>, <a class="el" href="main_8c-source.html#l00162">loopback_tcps()</a>, and <a class="el" href="main_8c-source.html#l00274">loopback_udp()</a>.</p>

</div>
</div><p>
</div>
<hr size="1"><address style="text-align: right;"><small>Generated on Fri Jan 2 12:20:00 2009 for W5300 - SOCKET APIs by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.6 </small></address>
</body>
</html>
